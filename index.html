<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CopyCat Installer</title>
    <link rel="icon" type="image/png" href="https://github.com/omsandippatil/CopyCat/edit/main/icons/icon128.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: monospace;
            background: #000;
            color: #fff;
            height: 100vh;
            overflow: hidden;
        }
        
        .game-area {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #000;
        }
        
        .center-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            color: #000;
            padding: 40px;
            border: 3px solid #000;
            text-align: center;
            max-width: 500px;
            z-index: 10;
        }
        
        h1 {
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .download {
            background: #000;
            color: #fff;
            padding: 15px 30px;
            text-decoration: none;
            display: inline-block;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .download:hover {
            background: #fff;
            color: #000;
            border: 2px solid #000;
        }
        
        .steps {
            text-align: left;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .step {
            margin: 5px 0;
        }
        
        .game-info {
            margin-top: 20px;
            font-size: 12px;
        }
        
        .cat {
            position: absolute;
            font-size: 30px;
            transition: all 0.1s ease;
            z-index: 5;
            user-select: none;
        }
        
        .mouse {
            position: absolute;
            font-size: 20px;
            z-index: 5;
            user-select: none;
            transition: all 0.2s ease;
        }
        
        .score {
            position: absolute;
            top: 30px;
            right: 30px;
            font-size: 20px;
            font-weight: bold;
            z-index: 15;
        }
        
        .instructions {
            position: absolute;
            top: 30px;
            left: 30px;
            font-size: 14px;
            z-index: 15;
            max-width: 200px;
            opacity: 1;
            transition: opacity 3s ease;
        }
        
        .instructions.fade {
            opacity: 0;
        }
    </style>
</head>
<body>
    <div class="game-area" id="gameArea">
        <div class="instructions" id="instructions">
            Use WASD or Arrow Keys<br>
            Catch the mice! üê≠<br>
            They run away from you!
        </div>
        
        <div class="score" id="score">Score: 0</div>
        
        <div class="center-box" id="centerBox">
            <h1>üê± CopyCat</h1>
            
            <a href="https://github.com/omsandippatil/CopyCat/archive/refs/tags/v1.0.0-meow.zip" 
               class="download" 
               download="CopyCat-v1.0.0-meow.zip">
                DOWNLOAD ZIP üê±
            </a>
            
            <div class="steps">
                <div class="step">1. Download ZIP file above</div>
                <div class="step">2. Extract/Unzip to a folder</div>
                <div class="step">3. Go to chrome://extensions/</div>
                <div class="step">4. Enable Developer mode</div>
                <div class="step">5. Click "Load unpacked" ‚Üí Select folder</div>
            </div>
            
            <div class="game-info">
                üê± Extensions need folders, not files<br>
                Extract ZIP first! Move with WASD/Arrows
            </div>
        </div>
        
        <div class="cat" id="cat">üê±</div>
    </div>

    <script>
        const gameArea = document.getElementById('gameArea');
        const cat = document.getElementById('cat');
        const scoreElement = document.getElementById('score');
        const centerBox = document.getElementById('centerBox');
        const instructions = document.getElementById('instructions');
        
        let catX = 100;
        let catY = 100;
        let score = 0;
        let mice = [];
        let gameStarted = false;
        
        // Audio context for sound effects
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Create sound effect
        function playSound(frequency, duration, type = 'sine') {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }
        
        // Sound effects
        function playCatchSound() {
            playSound(800, 0.1, 'square');
            setTimeout(() => playSound(1000, 0.1, 'square'), 50);
        }
        
        function playMoveSound() {
            playSound(200, 0.05, 'triangle');
        }
        
        // Fade instructions after first movement
        function startGame() {
            if (!gameStarted) {
                gameStarted = true;
                setTimeout(() => {
                    instructions.classList.add('fade');
                }, 2000);
            }
        }
        
        // Get game area boundaries and center box bounds
        function getGameBounds() {
            const centerBoxRect = centerBox.getBoundingClientRect();
            return {
                minX: 25,
                minY: 25,
                maxX: window.innerWidth - 55,
                maxY: window.innerHeight - 55,
                centerBox: {
                    left: centerBoxRect.left - 10, // Add padding to prevent clipping
                    right: centerBoxRect.right + 10,
                    top: centerBoxRect.top - 10,
                    bottom: centerBoxRect.bottom + 10
                }
            };
        }
        
        // Check if position collides with center box
        function collidesWithCenterBox(x, y, width, height, bounds) {
            return x < bounds.centerBox.right && 
                   x + width > bounds.centerBox.left && 
                   y < bounds.centerBox.bottom && 
                   y + height > bounds.centerBox.top;
        }
        
        // Find valid position that doesn't collide with center box
        function findValidPosition(bounds, width = 30, height = 30) {
            let x, y;
            let attempts = 0;
            do {
                x = Math.random() * (bounds.maxX - bounds.minX) + bounds.minX;
                y = Math.random() * (bounds.maxY - bounds.minY) + bounds.minY;
                attempts++;
            } while (collidesWithCenterBox(x, y, width, height, bounds) && attempts < 50);
            
            // If can't find valid position, place on edge away from center
            if (attempts >= 50) {
                const side = Math.floor(Math.random() * 4);
                switch(side) {
                    case 0: // top
                        x = Math.random() * (bounds.maxX - bounds.minX) + bounds.minX;
                        y = bounds.minY;
                        break;
                    case 1: // right
                        x = bounds.maxX - width;
                        y = Math.random() * (bounds.maxY - bounds.minY) + bounds.minY;
                        break;
                    case 2: // bottom
                        x = Math.random() * (bounds.maxX - bounds.minX) + bounds.minX;
                        y = bounds.maxY - height;
                        break;
                    case 3: // left
                        x = bounds.minX;
                        y = Math.random() * (bounds.maxY - bounds.minY) + bounds.minY;
                        break;
                }
            }
            
            return { x, y };
        }
        
        // Position cat with proper collision detection
        function updateCatPosition() {
            const bounds = getGameBounds();
            const catWidth = 30;
            const catHeight = 30;
            
            // Proposed new position
            let newX = Math.max(bounds.minX, Math.min(catX, bounds.maxX - catWidth));
            let newY = Math.max(bounds.minY, Math.min(catY, bounds.maxY - catHeight));
            
            // Check collision with center box and prevent movement into it
            if (collidesWithCenterBox(newX, newY, catWidth, catHeight, bounds)) {
                // Find the closest valid position
                const centerX = (bounds.centerBox.left + bounds.centerBox.right) / 2;
                const centerY = (bounds.centerBox.top + bounds.centerBox.bottom) / 2;
                
                // Push cat to the closest edge of the center box
                const distToLeft = Math.abs(newX + catWidth - bounds.centerBox.left);
                const distToRight = Math.abs(newX - bounds.centerBox.right);
                const distToTop = Math.abs(newY + catHeight - bounds.centerBox.top);
                const distToBottom = Math.abs(newY - bounds.centerBox.bottom);
                
                const minDist = Math.min(distToLeft, distToRight, distToTop, distToBottom);
                
                if (minDist === distToLeft) {
                    newX = bounds.centerBox.left - catWidth;
                } else if (minDist === distToRight) {
                    newX = bounds.centerBox.right;
                } else if (minDist === distToTop) {
                    newY = bounds.centerBox.top - catHeight;
                } else {
                    newY = bounds.centerBox.bottom;
                }
            }
            
            catX = newX;
            catY = newY;
            
            cat.style.left = catX + 'px';
            cat.style.top = catY + 'px';
        }
        
        // Create a mouse
        function createMouse() {
            if (mice.length >= 3) return;
            
            const mouse = document.createElement('div');
            mouse.className = 'mouse';
            mouse.textContent = 'üê≠';
            
            const bounds = getGameBounds();
            const pos = findValidPosition(bounds, 20, 20);
            
            mouse.style.left = pos.x + 'px';
            mouse.style.top = pos.y + 'px';
            mouse.mouseX = pos.x;
            mouse.mouseY = pos.y;
            mouse.speed = 2 + Math.random() * 3;
            
            gameArea.appendChild(mouse);
            mice.push(mouse);
        }
        
        // Move mice away from cat
        function moveMice() {
            const bounds = getGameBounds();
            
            mice.forEach(mouse => {
                const dx = mouse.mouseX - catX;
                const dy = mouse.mouseY - catY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 150) {
                    const angle = Math.atan2(dy, dx);
                    let newX = mouse.mouseX + Math.cos(angle) * mouse.speed;
                    let newY = mouse.mouseY + Math.sin(angle) * mouse.speed;
                    
                    newX = Math.max(bounds.minX, Math.min(newX, bounds.maxX - 20));
                    newY = Math.max(bounds.minY, Math.min(newY, bounds.maxY - 20));
                    
                    if (!collidesWithCenterBox(newX, newY, 20, 20, bounds)) {
                        mouse.mouseX = newX;
                        mouse.mouseY = newY;
                        mouse.style.left = newX + 'px';
                        mouse.style.top = newY + 'px';
                    }
                } else {
                    if (Math.random() < 0.1) {
                        const randomAngle = Math.random() * Math.PI * 2;
                        let newX = mouse.mouseX + Math.cos(randomAngle) * (mouse.speed / 2);
                        let newY = mouse.mouseY + Math.sin(randomAngle) * (mouse.speed / 2);
                        
                        newX = Math.max(bounds.minX, Math.min(newX, bounds.maxX - 20));
                        newY = Math.max(bounds.minY, Math.min(newY, bounds.maxY - 20));
                        
                        if (!collidesWithCenterBox(newX, newY, 20, 20, bounds)) {
                            mouse.mouseX = newX;
                            mouse.mouseY = newY;
                            mouse.style.left = newX + 'px';
                            mouse.style.top = newY + 'px';
                        }
                    }
                }
            });
        }
        
        // Check collision with mice
        function checkCollisions() {
            mice.forEach((mouse, index) => {
                const dx = mouse.mouseX - catX;
                const dy = mouse.mouseY - catY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 40) {
                    score += 10;
                    scoreElement.textContent = `Score: ${score}`;
                    playCatchSound();
                    mouse.remove();
                    mice.splice(index, 1);
                    
                    setTimeout(createMouse, 1000);
                }
            });
        }
        
        // Handle keyboard input
        document.addEventListener('keydown', (e) => {
            const speed = 8;
            let moved = false;
            
            switch(e.key.toLowerCase()) {
                case 'w':
                case 'arrowup':
                    catY -= speed;
                    moved = true;
                    break;
                case 's':
                case 'arrowdown':
                    catY += speed;
                    moved = true;
                    break;
                case 'a':
                case 'arrowleft':
                    catX -= speed;
                    moved = true;
                    break;
                case 'd':
                case 'arrowright':
                    catX += speed;
                    moved = true;
                    break;
            }
            
            if (moved) {
                startGame();
                playMoveSound();
                updateCatPosition();
                checkCollisions();
            }
        });
        
        // Game loop
        function gameLoop() {
            moveMice();
            checkCollisions();
            requestAnimationFrame(gameLoop);
        }
        
        // Initialize game
        updateCatPosition();
        createMouse();
        setTimeout(createMouse, 2000);
        gameLoop();
        
        setInterval(() => {
            if (mice.length < 3) {
                createMouse();
            }
        }, 3000);
        
        window.addEventListener('resize', updateCatPosition);
    </script>
</body>
</html>
